<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>scroll</title>
		<link rel="stylesheet" href="resource/reset.css">
		<style>
		    body{
    background: #ccc;

}
.scroll-demo{
    width: 540px;
    border: 1px solid  #e5e5e5;
    background: #fff;
    margin: 30px auto;
}
.scroll-tab{
    height: 34px;
    border-bottom: 1px solid #e5e5e5;
    color: #666;
    background: #f8f8f8;
}
.scroll-tab .tab-item{
    float: left;
    font: 14px/34px "Microsoft Yahei";
    height: 34px;
    text-align: center;
    border-right: 1px solid #e5e5e5;
    padding:   0 20px;
    cursor: pointer;

}
.scroll-tab .tab-active{
    color: #00be3c;
    background: #fff;
    border-top: 2px solid #00be3c;
    margin: -1px 0;
}
/*滚动内容区*/
.scroll-wrap{
   width: 100%;
   height: 300px;
   position: relative;

}
.scroll-wrap .scroll-cont{
    height: 100%;
    overflow: hidden;
    padding: 0 15px;
}
.scroll-wrap .scroll-cont h3{
    font: 16px/3 "Microsoft Yahei";
    text-align: center;
}
.scroll-wrap .scroll-cont p{
    font:14px/20px;
    text-indent: 2em;
    margin-bottom: 10px;
}
.scroll-wrap .scroll-bar{
    position: absolute;
    top: 0;
    right: 0;
    width: 10px;
    height: 100%;
    background: #eaeaea;
    cursor: pointer;
 
}
.scroll-wrap .scroll-slider{
    position: absolute;
    top: 0;
    right: 1px;
    width: 8px;
    height: 30px;
    background: #0f0;
    border-radius:30%
}

		</style>
	</head>
	<body>
		 <!--事例容器-->
    <div class="scroll-demo">
        <!--标签切换区-->
        <ul class="scroll-tab clearfix">
            <li class="tab-item tab-active">第一篇</li>
            <li class="tab-item ">第二篇</li>
            <li class="tab-item ">第三篇</li>
            <li class="tab-item ">第四篇</li>
        </ul>
        <!--滚动内容区域-->
        <div class="scroll-wrap">
            <!--滚动内容-->
            <div class="scroll-cont">
                <h3 class="anchor">春天来了</h3>
                <div class="scroll-ol">
                    <p>慕课网课程涵盖前端开发、PHP、Html5、Android、iOS、Swift等IT前沿技术语言，包括基础课程、 实用案例、高级分享三大类型，适合不同阶段的学习人群。以纯干货、短视频的形式为平台特点，为
                        在校学生、职场白领提供了一个迅速提升技能、共同分享进步的学习平台。[1]
                    </p>
                    <p>
                        4月2日，国内首个IT技能学习类应用——慕课网3.1.0版本在应用宝首发。据了解，在此次上线的版本 中，慕课网新增了课程历史记录、相关课程推荐等四大功能，为用户营造更加丰富的移动端IT学习体验。[2]
                    </p>
                    <p>慕课网课程涵盖前端开发、PHP、Html5、Android、iOS、Swift等IT前沿技术语言，包括基础课程、 实用案例、高级分享三大类型，适合不同阶段的学习人群。以纯干货、短视频的形式为平台特点，为
                        在校学生、职场白领提供了一个迅速提升技能、共同分享进步的学习平台。[1]
                    </p>
                    <p>
                        4月2日，国内首个IT技能学习类应用——慕课网3.1.0版本在应用宝首发。据了解，在此次上线的版本 中，慕课网新增了课程历史记录、相关课程推荐等四大功能，为用户营造更加丰富的移动端IT学习体验。[2]
                    </p>
                </div>
                <h3 class="anchor">夏天来了</h3>
                <div class="scroll-ol">
                    <p>慕课网课程涵盖前端开发、PHP、Html5、Android、iOS、Swift等IT前沿技术语言，包括基础课程、 实用案例、高级分享三大类型，适合不同阶段的学习人群。以纯干货、短视频的形式为平台特点，为
                        在校学生、职场白领提供了一个迅速提升技能、共同分享进步的学习平台。[1]
                    </p>
                    <p>
                        4月2日，国内首个IT技能学习类应用——慕课网3.1.0版本在应用宝首发。据了解，在此次上线的版本 中，慕课网新增了课程历史记录、相关课程推荐等四大功能，为用户营造更加丰富的移动端IT学习体验。[2]
                    </p>
                    <p>
                        4月2日，国内首个IT技能学习类应用——慕课网3.1.0版本在应用宝首发。据了解，在此次上线的版本 中，慕课网新增了课程历史记录、相关课程推荐等四大功能，为用户营造更加丰富的移动端IT学习体验。[2]
                    </p>
                </div>
                <h3 class="anchor">秋天来了</h3>
                <div class="scroll-ol">
                    <p>慕课网课程涵盖前端开发、PHP、Html5、Android、iOS、Swift等IT前沿技术语言，包括基础课程、 实用案例、高级分享三大类型，适合不同阶段的学习人群。以纯干货、短视频的形式为平台特点，为
                        在校学生、职场白领提供了一个迅速提升技能、共同分享进步的学习平台。[1]
                    </p>
                    <p>
                        4月2日，国内首个IT技能学习类应用——慕课网3.1.0版本在应用宝首发。据了解，在此次上线的版本 中，慕课网新增了课程历史记录、相关课程推荐等四大功能，为用户营造更加丰富的移动端IT学习体验。[2]
                    </p>
                </div>
                <h3 class="anchor">冬天来了</h3>
                <div class="scroll-ol">
                    <p>慕课网课程涵盖前端开发、PHP、Html5、Android、iOS、Swift等IT前沿技术语言，包括基础课程、 实用案例、高级分享三大类型，适合不同阶段的学习人群。以纯干货、短视频的形式为平台特点，为
                        在校学生、职场白领提供了一个迅速提升技能、共同分享进步的学习平台。[1]
                    </p>
                    <p>
                        4月2日，国内首个IT技能学习类应用——慕课网3.1.0版本在应用宝首发。据了解，在此次上线的版本 中，慕课网新增了课程历史记录、相关课程推荐等四大功能，为用户营造更加丰富的移动端IT学习体验。[2]
                    </p>
                </div>
                <div class="correct-bot"></div>
            </div>
            <!--滚动条-->
            <div class="scroll-bar">
                <!--滚动滑块-->
                <div class="scroll-slider"></div>
            </div>
        </div>

    </div>
		<script type="text/javascript" src="resource/jquery-1.8.2.min.js"></script>
		<script>
			// var Scroll={};//构造函数只能在内部调用，如果要在外边调用需要，创建一个对象，接一下构造函数。
			(function(win,doc,$){
                function CusScrollBar(options){
                    this._init(options);
                }
                $.extend(CusScrollBar.prototype,{
                	_init:function(options){
                		var self = this;//防止this混用
                		self.options = {
                			scrollDir     :"y",//滚动的方向
                			contSelector  :"",//滚动内容区域选择器
                			barSelector   :"",//滚动条选择器
                			sliderSelector:"",//滚动滑块选择器
                			wheelStep     :10,//滚动步长
                		}
                		$.extend(true,self.options,options||{});
                        self._initDomEvent();
                        self._initSliderDragEvent();
                        self._bindMousewheel();
                		return self;
                	},
                	/**
                	 *初始化DOM引用
                	 *@method _initDomEvent
                	 *@return {CusScrollBar}
                	*/
                	_initDomEvent:function(){
                		var opts=this.options;
                		//滚动内容区域对象，必填项
                		this.$cont=$(opts.contSelector);
                		//滚动滑块对象，必填项
                		this.$slider=$(opts.sliderSelector);
                		//滚动条对象
                		this.$bar=$(opts.barSelector);
                		//获取文档对象
                		this.$doc=$(doc);
                		this._initSliderDragEvent()
                		    ._bindContScroll();
                	},
                	/**
                	 *初始化滑块拖动功能
                	 *@return {[Object]} [this]
                	*/
                	_initSliderDragEvent:function(){
                       var self=this,
                           slider=self.$slider,
                           sliderEl=slider[0];
                        if(sliderEl){
                        	var doc=self.$doc,
                        	    dragStartPagePosition,
                        	    dragStartScrollPosition,
                        	    dragContBarRate;
                            function mousemoveHandler(e){
                            	e.preventDefault();
                            	console.log("mousemove");
                            	if(dragStartPagePosition==null){
                            		return;
                            	}
                            	self.scrollTo(dragStartScrollPosition+(e.pageY-dragStartPagePosition)*dragContBarRate);
                            }
                        	slider.on("mousedown",function(e){
                        		  e.preventDefault();
                        		  console.log("mousedown");
                        		  dragStartPagePosition=e.pageY;//鼠标相对于滚动条顶部的距离
                        		  dragStartScrollPosition=self.$cont[0].scrollTop;
                        		  dragContBarRate=self.getMaxScrollPosition()/self.getMaxSliderPosition();//内容可移动高度与滑块可移动距离的比例
                                  doc.on("mousemove.scroll",mousemoveHandler)
                                     .on("mouseup.scroll",function(e){
                                 	console.log("mouseup");
                                    doc.off(".scroll");//解除命名空间（scroll）里面所有的事件
                                 });
                        	});
                        }
                        return self;
                	},
                	//监听内容的滚动，同步滑块的位置
                	_bindContScroll:function(){
                      var self=this;
                      self.$cont.on("scroll",function(){
                      	 var sliderEl=self.$slider&&self.$slider[0];
                      	 if(sliderEl){
                      	 	sliderEl.style.top=self.getSliderPosition()+"px";
                      	 }
                      });
                      return self;
                	},
                	_bindMousewheel:function(){
                		var self=this;	
                		self.$cont.on("mousewheel DOMMouseScroll",function(e){
                			e.preventDefault();
                			var oEv=e.originalEvent;
                		    var wheelRange=oEv.wheelDelta?-oEv.wheelDelta/120:(oEv.detail||0)/3;//滚动幅度
                		  self.scrollTo(self.$cont[0].scrollTop+wheelRange*self.options.wheelStep); 
                		});
                		return self;
                	},
                	//计算滑块的当前位置
                	getSliderPosition:function(){
                       var self=this,
                          maxSliderPosition=self.getMaxSliderPosition();
                       return Math.min(maxSliderPosition,maxSliderPosition*self.$cont[0].scrollTop/self.getMaxScrollPosition());
                	},
                	//内容可滚动高度
                	getMaxScrollPosition:function(){
                       var self=this;
                       console.info("self.$cont.height()="+self.$cont.height())
                       console.info("self.$cont[0].scrollHeight="+self.$cont[0].scrollHeight)
                       return Math.max(self.$cont.height(),self.$cont[0].scrollHeight)-self.$cont.height();
                	},
                	//滑块可以移动距离
                	getMaxSliderPosition:function(){
                		var self=this;
                		console.info("self.$bar.height()="+self.$bar.height())
                       console.info("self.$slider.height()="+self.$slider.height())
                       return self.$bar.height()-self.$slider.height();
                	},
                	scrollTo:function(positionVal){
                          var self=this;
                          self.$cont.scrollTop(positionVal);
                	}
                });
                win.CusScrollBar=CusScrollBar;
			})(window,document,jQuery);
			new CusScrollBar({
				contSelector  :".scroll-cont",//滚动内容区域选择器
    			barSelector   :".scroll-bar",//滚动条选择器
    			sliderSelector:".scroll-slider",//滚动滑块选择器
			});//实现的实例化对象
		</script>
	</body>
</html>